all_sheets <- excel_sheets(file_path)
for (sheet_name in all_sheets) {
var_name <- make.names(sheet_name)
assign(var_name, read_excel(file_path, sheet = sheet_name))
}
source("E:/Eranthis/Analysis.R", echo=TRUE)
# START -----------------------------------------------------------------------------------------------------------
Sys.setenv(LANG = "en_US.UTF-8")
#Library
library(pacman)
pacman::p_load(
lubridate,
purrr,
dplyr,
tidyr,
forecast,
zoo,
rlang,
ggplot2,
tidyverse,
raster,
sp,
geodata,
terra,
rasterVis,
BiocManager,
devtools,
dismo,
XML,
jsonlite,
rgdal,
rJava,
readxl,
rgbif,
leaflet
)
# Read all lists in file
file_path <- "E:/Eranthis/Eranthis_morph.xlsx"
all_sheets <- excel_sheets(file_path)
for (sheet_name in all_sheets) {
var_name <- make.names(sheet_name)
assign(var_name, read_excel(file_path, sheet = sheet_name))
}
View(E.byunsanensis)
View(E.byunsanensis)
View(E..tanhoensis)
pacman::p_load(lubridate, purrr, dplyr, tidyr, forecast, zoo, rlang, ggplot2, tidyverse, raster,
sp, geodata, terra, rasterVis, BiocManager, devtools, dismo, XML, jsonlite, rgdal, rJava,
readxl, rgbif, leaflet, factoextra, NbClust, cluster
)
Eranthis <- bind_rows(all_sheets)
Eranthis <- <- bind_rows(all_sheets[[1]], all_sheets[[2]], ..., all_sheets[[12]])
Eranthis <- bind_rows(all_sheets[[1]], all_sheets[[2]], ..., all_sheets[[12]])
Eranthis <- bind_rows(all_sheets[[1]], all_sheets[[2]], all_sheets[[3]], all_sheets[[4]], all_sheets[[5]],
all_sheets[[6]], all_sheets[[7]], all_sheets[[8]], all_sheets[[9]], all_sheets[[10]],
all_sheets[[11]], all_sheets[[12]])
Eranthis <- bind_cols(all_sheets[[1]], all_sheets[[2]], all_sheets[[3]], all_sheets[[4]], all_sheets[[5]],
all_sheets[[6]], all_sheets[[7]], all_sheets[[8]], all_sheets[[9]], all_sheets[[10]],
all_sheets[[11]], all_sheets[[12]])
View(Eranthis)
View(E..albiflora)
list()
# START -----------------------------------------------------------------------------------------------------------
Sys.setenv(LANG = "en_US.UTF-8")
#Library
library(pacman)
pacman::p_load(lubridate, purrr, dplyr, tidyr, forecast, zoo, rlang, ggplot2, tidyverse, raster,
sp, geodata, terra, rasterVis, BiocManager, devtools, dismo, XML, jsonlite, rgdal, rJava,
readxl, rgbif, leaflet, factoextra, NbClust, cluster
)
# Read all lists in file
file_path <- "E:/Eranthis/Eranthis_morph.xlsx"
all_sheets <- excel_sheets(file_path)
for (sheet_name in all_sheets) {
var_name <- make.names(sheet_name)
assign(var_name, read_excel(file_path, sheet = sheet_name))
}
combined_data <- bind_rows(all_sheets)
combined_data <- bind_cols(all_sheets)
View(combined_data)
View(E.albiflora)
View(E.byunsanensis)
View(E.krasnoborovii)
combined_data <- do.call(bind_rows, all_sheets)
all_sheets <- list(all_sheets)
combined_data <- bind_rows(all_sheets)
combined_data <- do.call(bind_rows, all_sheets)
all_sheets <- excel_sheets(file_path)
all_sheets <- vector(all_sheets)
combined_data <- bind_rows(all_sheets)
all_are_data_frames <- all(sapply(all_sheets, is.data.frame))
if (all_are_data_frames) {
# Объединение таблиц в одну
combined_data <- bind_rows(all_sheets)
} else {
warning("Not all elements in the list are data frames.")
combined_data <- NULL  # или другая обработка ошибки по вашему усмотрению
}
all_sheets
all_dataframes <- list(E.sibirica, E.tanhoensis, E.sibirica_x_E.tanhoensis, E.krasnoborovii, E.sineli,
E.stellata, E.stellata(Korea), E.pinnatifida, E.pungdoensis, E.albiflora,
E.lobulata, E.byunsanensis)
all_dataframes <- list("E.sibirica", "E.tanhoensis", "E.sibirica_x_E.tanhoensis", "E.krasnoborovii", "E.sineli",
"E.stellata", "E.stellata(Korea)", "E.pinnatifida", "E.pungdoensis", "E.albiflora",
"E.lobulata", "E.byunsanensis")
combined_data <- bind_rows(all_dataframes)
combined_data <- bind_rows(lapply(all_dataframes, get))
all_dataframes <- list("E.sibirica", "E.tanhoensis", "E.sibirica_x_E.tanhoensis", "E.krasnoborovii", "E.sineli",
"E.stellata", "E.stellata.Korea.", "E.pinnatifida", "E.pungdoensis", "E.albiflora",
"E.lobulata", "E.byunsanensis")
combined_data <- bind_rows(lapply(all_dataframes, get))
tables <- lapply(all_dataframes, get)
# Преобразование типов данных всех столбцов к типу "character"
tables <- lapply(tables, function(tbl) mutate_all(tbl, as.character))
# Объединение таблиц в одну
combined_data <- bind_rows(tables)
View(combined_data)
View(combined_data)
# Выберем только нужные столбцы для кластеризации
data_for_clustering <- combined_data %>% select(Species, PHfl)
# Кластеризация методом k-средних (k-means)
kmeans_result <- kmeans(data_for_clustering, centers = 3)  # Укажите желаемое количество кластеров
# Выберем только нужные столбцы для кластеризации
data_for_clustering <- combined_data %>% select(Species, PHfl)
# Выберем только нужные столбцы для кластеризации
data_for_clustering <- combined_data %>% dplyr::select(Species, PHfl)
# Кластеризация методом k-средних (k-means)
kmeans_result <- kmeans(data_for_clustering, centers = 3)  # Укажите желаемое количество кластеров
View(data_for_clustering)
data_for_clustering <- na.omit(data_for_clustering)
# Кластеризация методом k-средних (k-means)
kmeans_result <- kmeans(data_for_clustering, centers = 3)  # Укажите желаемое количество кластеров
View(data_for_clustering)
# Кластеризация методом k-средних (k-means)
kmeans_result <- kmeans(data_for_clustering, centers = 3, na.action = na.exclude)  # Укажите желаемое количество кластеров
# Выберем только нужные столбцы для кластеризации
data_for_clustering <- combined_data %>% dplyr::select(Species, PHfl)
data_for_clustering <- data_for_clustering[complete.cases(data_for_clustering), ]
# Кластеризация методом k-средних (k-means)
kmeans_result <- kmeans(data_for_clustering, centers = 3, na.action = na.exclude)
# Кластеризация методом k-средних (k-means)
kmeans_result <- kmeans(data_for_clustering, centers = 3)
data_for_clustering$PHfl <- as.numeric(data_for_clustering$PHfl)
# Кластеризация методом k-средних (k-means)
kmeans_result <- kmeans(data_for_clustering, centers = 3)
# Выберем только нужные столбцы для кластеризации
data_for_clustering <- combined_data %>% dplyr::select(Species, PHfl)
data_for_clustering$PHfl <- as.numeric(data_for_clustering$PHfl)
data_for_clustering <- data_for_clustering[complete.cases(data_for_clustering), ]
# Кластеризация методом k-средних (k-means)
kmeans_result <- kmeans(data_for_clustering, centers = 3)
View(data_for_clustering)
# Выберем только нужные столбцы для кластеризации
data_for_clustering <- combined_data %>% dplyr::select(Species, PHfl)
data_for_clustering$PHfl <- as.numeric(data_for_clustering$PHfl)
data_for_clustering <- data_for_clustering[complete.cases(data_for_clustering), ]
# Кластеризация методом k-средних (k-means)
kmeans_result <- kmeans(data_for_clustering, centers = 3)
data_for_clustering$PHfl <- as.numeric(as.character(data_for_clustering$PHfl), na.rm = TRUE)
# Кластеризация методом k-средних (k-means)
kmeans_result <- kmeans(data_for_clustering, centers = 3)
hc <- hclust(combined_data, method = "ward.D2")
hc <- hclust(combined_data, method = "ward.D2", is.na = TRUE)
data_for_clustering <- combined_data %>% select(Species, PHfl)
data_for_clustering <- combined_data %>% dplyr::select(Species, PHfl)
# Create a distance matrix
dist_matrix <- dist(data_for_clustering)
# Perform hierarchical clustering
hc <- hclust(dist_matrix, method = "ward.D2")
# Create a distance matrix
data_for_clustering <- impute(data_for_clustering, fun = mean)
pacman::p_load(lubridate, purrr, dplyr, tidyr, forecast, zoo, rlang, ggplot2, tidyverse, raster,
sp, geodata, terra, rasterVis, BiocManager, devtools, dismo, XML, jsonlite, rgdal, rJava,
readxl, rgbif, leaflet, factoextra, NbClust, cluster, Hmisc
)
# Create a distance matrix
data_for_clustering <- impute(data_for_clustering, fun = mean)
# Create a distance matrix
preProcessModel <- preProcess(data_for_clustering, method = c("medianImpute", "YeoJohnson"))
pacman::p_load(lubridate, purrr, dplyr, tidyr, forecast, zoo, rlang, ggplot2, tidyverse, raster,
sp, geodata, terra, rasterVis, BiocManager, devtools, dismo, XML, jsonlite, rgdal, rJava,
readxl, rgbif, leaflet, factoextra, NbClust, cluster, Hmisc, caret
)
# Create a distance matrix
preProcessModel <- preProcess(data_for_clustering, method = c("medianImpute", "YeoJohnson"))
imputed_data <- predict(preProcessModel, data_for_clustering)
dist_matrix <- dist(data_for_clustering)
# Perform hierarchical clustering
hc <- hclust(dist_matrix, method = "ward.D2")
pacman::p_load(lubridate, purrr, dplyr, tidyr, forecast, zoo, rlang, ggplot2, tidyverse, raster,
sp, geodata, terra, rasterVis, BiocManager, devtools, dismo, XML, jsonlite, rgdal, rJava,
readxl, rgbif, leaflet, factoextra, NbClust, cluster, Hmisc, caret, mice
)
imputed_data <- mice(data_for_clustering, method = "pmm", m = 5, maxit = 50)
data_for_clustering <- na.omit(data_for_clustering)
# Create a distance matrix
dist_matrix <- dist(imputed_data)
# Perform hierarchical clustering
hc <- hclust(dist_matrix, method = "ward.D2")
pacman::p_load(lubridate, purrr, dplyr, tidyr, forecast, zoo, rlang, ggplot2, tidyverse, raster,
sp, geodata, terra, rasterVis, BiocManager, devtools, dismo, XML, jsonlite, rgdal, rJava,
readxl, rgbif, leaflet, factoextra, NbClust, cluster, Hmisc, caret, mice, missForest
)
imputed_data <- missForest(data_for_clustering)$ximp
imputed_data <- missForest(data_for_clustering)$PHfl
data_for_clustering$PHfl <- as.numeric(data_for_clustering$PHfl)
imputed_data <- missForest(data_for_clustering)$PHfl
View(data_for_clustering)
data_for_clustering <- combined_data %>% dplyr::select(Species, PHfl)
data_for_clustering$PHfl <- as.numeric(data_for_clustering$PHfl)
imputed_data <- missForest(data_for_clustering)$PHfl
# START -----------------------------------------------------------------------------------------------------------
Sys.setenv(LANG = "en_US.UTF-8")
#Library
library(pacman)
pacman::p_load(lubridate, purrr, dplyr, tidyr, forecast, zoo, rlang, ggplot2, tidyverse, raster,
sp, geodata, terra, rasterVis, BiocManager, dismo, XML, jsonlite, rgdal, rJava,
readxl, rgbif, factoextra, NbClust, cluster, openxlsx, caret, mice, missForest, knitr
)
# Read all lists in file
file_path <- "E:/Eranthis/Eranthis_morph.xlsx"
all_sheets <- excel_sheets(file_path)
for (sheet_name in all_sheets) {
var_name <- make.names(sheet_name)
assign(var_name, read_excel(file_path, sheet = sheet_name))
}
all_dataframes <- list("E.sibirica", "E.tanhoensis", "E.sibirica_x_E.tanhoensis", "E.krasnoborovii", "E.sineli",
"E.stellata", "E.stellata.Korea.", "E.pinnatifida", "E.pungdoensis", "E.albiflora",
"E.lobulata", "E.byunsanensis")
#Making One table
tables <- lapply(all_dataframes, get)
tables <- lapply(tables, as.data.frame)
tables <- lapply(tables, function(tbl) mutate_all(tbl, as.character))
combined_data <- bind_rows(tables)
#MAking Means to one SP
combined_data <- combined_data %>%
group_by(PHfl) %>%
summarize(across(everything(), mean))
View(combined_data)
#Making One table
tables <- lapply(all_dataframes, get)
tables <- lapply(tables, as.data.frame)
tables <- lapply(tables, function(tbl) mutate_all(tbl, as.character))
combined_data <- bind_rows(tables)
View(combined_data)
#MAking Means to One
combined_data <- combined_data %>%
group_by(Species) %>%
summarize(across(everything(), mean))
combined_data <- bind_rows(tables)
#MAking Means to One
combined_data <- combined_data %>%
group_by(Species) %>%
summarize(across(everything(), ~ mean(., na.rm = TRUE)))
View(combined_data)
combined_data <- bind_rows(tables)
View(combined_data)
write.xlsx(combined_data, "combined_data.xlsx", rowNames = FALSE)
combined_data <- read.xlsx("combined_data.xlsx")
View(combined_data)
#MAking Means to One
combined_data <- combined_data %>%
mutate_at(vars(2:45), as.numeric)
combined_data <- combined_data %>%
group_by(Species) %>%
summarize(across(everything(), ~ mean(., na.rm = TRUE)))
View(combined_data)
# Create a distance matrix
dist_matrix <- dist(combined_data)
View(combined_data)
# START -----------------------------------------------------------------------------------------------------------
Sys.setenv(LANG = "en_US.UTF-8")
#Library
library(pacman)
pacman::p_load(lubridate, purrr, dplyr, tidyr, forecast, zoo, rlang, ggplot2, tidyverse, raster,
sp, geodata, terra, rasterVis, BiocManager, dismo, XML, jsonlite, rgdal, rJava,
readxl, rgbif, factoextra, NbClust, cluster, openxlsx, caret, mice, missForest, knitr
)
# Read all lists in file
file_path <- "E:/Eranthis/Eranthis_morph.xlsx"
all_sheets <- excel_sheets(file_path)
for (sheet_name in all_sheets) {
var_name <- make.names(sheet_name)
assign(var_name, read_excel(file_path, sheet = sheet_name))
}
all_dataframes <- list("E.sibirica", "E.tanhoensis", "E.sibirica_x_E.tanhoensis", "E.krasnoborovii", "E.sineli",
"E.stellata", "E.stellata.Korea.", "E.pinnatifida", "E.pungdoensis", "E.albiflora",
"E.lobulata", "E.byunsanensis")
# For Making Means instead of NA
for (df_name in all_dataframes) {
df <- get(df_name)
df <- lapply(df, function(x) {
ifelse(is.na(x), mean(x, na.rm = TRUE), x)
})
assign(df_name, df, envir = .GlobalEnv)
}
#Making One table
tables <- lapply(all_dataframes, get)
tables <- lapply(tables, as.data.frame)
tables <- lapply(tables, function(tbl) mutate_all(tbl, as.character))
combined_data <- bind_rows(tables)
write.xlsx(combined_data, "combined_data.xlsx", rowNames = FALSE)
combined_data <- read.xlsx("combined_data.xlsx")
#MAking Means to One
combined_data <- combined_data %>%
mutate_at(vars(2:45), as.numeric)
combined_data <- combined_data %>%
group_by(Species) %>%
summarize(across(everything(), ~ mean(., na.rm = TRUE)))
# Create a distance matrix
dist_matrix <- dist(combined_data)
# Perform hierarchical clustering
hc <- hclust(dist_matrix, method = "ward.D2")
# Plot the dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = NULL, xlab = NULL, cex = 5, labels = combined_data$Species)
# Plot the dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = NULL, xlab = NULL, cex = 0.8, labels = combined_data$Species)
# Read all lists in file
file_path <- "E:/Eranthis/Eranthis_morph.xlsx"
all_sheets <- excel_sheets(file_path)
for (sheet_name in all_sheets) {
var_name <- make.names(sheet_name)
assign(var_name, read_excel(file_path, sheet = sheet_name))
}
all_dataframes <- list("E.sibirica", "E.tanhoensis", "E.sibirica_x_E.tanhoensis", "E.krasnoborovii", "E.sineli",
"E.stellata", "E.stellata.Korea.", "E.pinnatifida", "E.pungdoensis", "E.albiflora",
"E.lobulata", "E.byunsanensis")
#Making One table
tables <- lapply(all_dataframes, get)
tables <- lapply(tables, as.data.frame)
tables <- lapply(tables, function(tbl) mutate_all(tbl, as.character))
combined_data <- bind_rows(tables)
write.xlsx(combined_data, "combined_data.xlsx", rowNames = FALSE)
combined_data <- read.xlsx("combined_data.xlsx")
combined_data <- combined_data %>%
mutate_at(vars(2:45), as.numeric)
print(cor(combined_data), digits = 2)
# Выбираем только числовые столбцы
numeric_columns <- combined_data %>%
select_if(is.numeric)
# Вычисляем корреляцию
correlation_matrix <- cor(numeric_columns)
# Выводим матрицу корреляции
print(correlation_matrix, digits = 2)
# START -----------------------------------------------------------------------------------------------------------
Sys.setenv(LANG = "en_US.UTF-8")
#Library
library(pacman)
pacman::p_load(lubridate, purrr, dplyr, tidyr, forecast, zoo, rlang, ggplot2, tidyverse, raster,
sp, geodata, terra, rasterVis, BiocManager, dismo, XML, jsonlite, rgdal, rJava,
readxl, rgbif, factoextra, NbClust, cluster, caret, mice, missForest, knitr
)
# Read all lists in file
file_path <- "E:/Eranthis/White_E.xlsx"
White <- read_xlsx("White_E.xlsx")
# Create a distance matrix
dist_matrix <- dist(White)
# Perform hierarchical clustering
hc <- hclust(dist_matrix, method = "ward.D2")
# Perform hierarchical clustering
hc <- hclust(dist_matrix, method = "ward.D")
# Plot the dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = NULL, xlab = NULL, cex = 0.8, labels = White$Number)
White$Num_SP <- paste(White$Number, White$Species, sep = "_")
View(White)
# Plot the dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = NULL, xlab = NULL, cex = 0.8, labels = White$Num_SP)
# Plot the dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = NULL, xlab = NULL, cex = 1, labels = White$Num_SP)
# Plot the dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = NULL, xlab = NULL, cex = 0.8, labels = White$Num_SP)
# Plot the dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = NULL, xlab = NULL, cex = 1, labels = White$Num_SP)
# Plot the dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = NULL, xlab = NULL, cex = 1, labels = White$Num_SP)
# START -----------------------------------------------------------------------------------------------------------
Sys.setenv(LANG = "en_US.UTF-8")
#Library
library(pacman)
pacman::p_load(lubridate, purrr, dplyr, tidyr, forecast, zoo, rlang, ggplot2, tidyverse, raster,
sp, geodata, terra, rasterVis, BiocManager, dismo, XML, jsonlite, rgdal, rJava,
readxl, rgbif, factoextra, NbClust, cluster, openxlsx, caret, mice, missForest, knitr
)
# Read all lists in file
file_path <- "E:/Eranthis/Eranthis_morph.xlsx"
all_sheets <- excel_sheets(file_path)
for (sheet_name in all_sheets) {
var_name <- make.names(sheet_name)
assign(var_name, read_excel(file_path, sheet = sheet_name))
}
all_dataframes <- list("E.sibirica", "E.tanhoensis", "E.sibirica_x_E.tanhoensis", "E.krasnoborovii", "E.sineli",
"E.stellata", "E.stellata.Korea.", "E.pinnatifida", "E.pungdoensis", "E.albiflora",
"E.lobulata", "E.byunsanensis")
#Making One table
tables <- lapply(all_dataframes, get)
tables <- lapply(tables, as.data.frame)
tables <- lapply(tables, function(tbl) mutate_all(tbl, as.character))
combined_data <- bind_rows(tables)
write.xlsx(combined_data, "combined_data.xlsx", rowNames = FALSE)
combined_data <- read.xlsx("combined_data.xlsx")
View(combined_data)
# START -----------------------------------------------------------------------------------------------------------
Sys.setenv(LANG = "en_US.UTF-8")
#Library
library(pacman)
pacman::p_load(lubridate, purrr, dplyr, tidyr, forecast, zoo, rlang, ggplot2, tidyverse, raster,
sp, geodata, terra, rasterVis, BiocManager, dismo, XML, jsonlite, rgdal, rJava,
readxl, rgbif, factoextra, NbClust, cluster, caret, mice, missForest, knitr
)
# Read all lists in file
file_path <- "E:/Eranthis/White_E.xlsx"
White <- read_xlsx("White_E.xlsx")
White$Num_SP <- paste(White$Number, White$Species, sep = "_")
# Create a distance matrix
dist_matrix <- dist(White)
# Perform hierarchical clustering
hc <- hclust(dist_matrix, method = "complete")
# Plot the dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = NULL, xlab = NULL, cex = 1, labels = White$Num_SP)
# Perform hierarchical clustering
hc <- hclust(dist_matrix, method = "single")
# Plot the dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = NULL, xlab = NULL, cex = 1, labels = White$Num_SP)
# Perform hierarchical clustering
hc <- hclust(dist_matrix, method = "average")
# Plot the dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = NULL, xlab = NULL, cex = 1, labels = White$Num_SP)
# Perform hierarchical clustering
hc <- hclust(dist_matrix, method = "mcquitty")
# Plot the dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = NULL, xlab = NULL, cex = 1, labels = White$Num_SP)
# Perform hierarchical clustering
hc <- hclust(dist_matrix, method = "median")
# Plot the dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = NULL, xlab = NULL, cex = 1, labels = White$Num_SP)
# Plot the dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = NULL, xlab = NULL, cex = 1.2, labels = White$Num_SP)
# Plot the dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = NULL, xlab = NULL, cex = 0.8, labels = White$Num_SP)
# Perform hierarchical clustering
hc <- hclust(dist_matrix, method = "centroid")
# Plot the dendrogram
plot(hc, main = "Hierarchical Clustering Dendrogram", sub = NULL, xlab = NULL, cex = 1, labels = White$Num_SP)
# START -----------------------------------------------------------------------------------------------------------
Sys.setenv(LANG = "en_US.UTF-8")
#Library
library(pacman)
pacman::p_load(lubridate, purrr, dplyr, tidyr, forecast, zoo, rlang, ggplot2, tidyverse, raster,
sp, geodata, terra, rasterVis, BiocManager, dismo, XML, jsonlite, rgdal, rJava,
readxl, rgbif, factoextra, NbClust, cluster, caret, mice, missForest, knitr
)
# Read all lists in file
file_path <- "E:/Eranthis/White_E.xlsx"
White <- read_xlsx("White_E.xlsx")
White$Num_SP <- paste(White$Number, White$Species, sep = "_")
View(White)
# START -----------------------------------------------------------------------------------------------------------
Sys.setenv(LANG = "en_US.UTF-8")
#Library
library(pacman)
pacman::p_load(lubridate, purrr, dplyr, tidyr, forecast, zoo, rlang, ggplot2, tidyverse, raster,
sp, geodata, terra, rasterVis, BiocManager, dismo, XML, jsonlite, rgdal, rJava,
readxl, rgbif, factoextra, NbClust, cluster, openxlsx, caret, mice, missForest, knitr
)
# Read all lists in file
file_path <- "E:/Eranthis/Eranthis_morph.xlsx"
all_sheets <- excel_sheets(file_path)
for (sheet_name in all_sheets) {
var_name <- make.names(sheet_name)
assign(var_name, read_excel(file_path, sheet = sheet_name))
}
all_dataframes <- list("E.sibirica", "E.tanhoensis", "E.sibirica_x_E.tanhoensis", "E.krasnoborovii", "E.sineli",
"E.stellata", "E.stellata.Korea.", "E.pinnatifida", "E.pungdoensis", "E.albiflora",
"E.lobulata", "E.byunsanensis")
tables
tables
tables
#Making One table
tables <- lapply(all_dataframes, get)
tables <- lapply(tables, as.data.frame)
tables <- lapply(tables, function(tbl) mutate_all(tbl, as.character))
combined_data <- bind_rows(tables)
write.xlsx(combined_data, "combined_data.xlsx", rowNames = FALSE)
View(combined_data)
combined_data <- read.xlsx("combined_data.xlsx")
pca_result <- prcomp(combined_data, scale. = TRUE)
pca_result <- prcomp(combined_data, scale. = TRUE, na.rm = TRUE)
pca_result <- prcomp(combined_data, scale. = TRUE, na.action = TRUE)
pca_result <- prcomp(combined_data, scale. = TRUE, na.action)
combined_data <- combined_data %>%
mutate_at(vars(2:45), as.numeric)
pca_result <- prcomp(combined_data, scale. = TRUE)
combined_data_factorized <- lapply(combined_data, function(x) {
if(is.character(x)) {
as.factor(x)
} else {
x
}
})
combined_data_factorized <- as.data.frame(combined_data_factorized)
pca_result <- prcomp(combined_data_factorized, scale. = TRUE)
combined_data_clean <- na.omit(combined_data_factorized)
View(combined_data_clean)
pca_result <- prcomp(combined_data_factorized, scale. = TRUE, na.fail)
pacman::p_load(lubridate, purrr, dplyr, tidyr, forecast, zoo, rlang, ggplot2, tidyverse, raster,
sp, geodata, terra, rasterVis, BiocManager, dismo, XML, jsonlite, rgdal, rJava,
readxl, rgbif, factoextra, NbClust, cluster, openxlsx, caret, mice, missForest, knitr, FactoMineR
)
View(combined_data)
PCA(combined_data, scale.unit = TRUE, ncp = 3, graph = TRUE)
library(installr)
updateR()
